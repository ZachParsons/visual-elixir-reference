\matrix [fptk, map=b] {
    \keyvaluex[1]{$a_1$}{$c_1$} &
    \keyvaluex[2]{$a_2$}{$c_2$} &
    \elems &
    \keyvaluex[n]{$a_n$}{$c_n$} \\
};

\node (legend) [right=.5 of bn]
    {$c_j=\displaystyle\sum_{i=1}^{n}|a_i=a_j$};

\coordinate (x) at ($ (b1.west)!.5!(legend.east) $);

\matrix [fptk, list=a, above=2 of x |- b.north] {
    \elem{1} &
    \elem{2} &
    \elem{1} &
    \elems &
    \elem{n} &
    \elem{2} &
    \elems &
    \elem{1} &
    \elem{n} \\
};

\bigarrowdown{$ (b.north)!.5!(b.north |- a.south) $};
