\newcommand\stp{\texttt{\small{s}}}
\newcommand\cnt{\texttt{\small{c}}}

\matrix [fptk, list=a] {
    \elem{1} &
    \elems[.75] &
    \elemx{c}{$a_{\cnt}$}; &
    \elems[1] &
    \elemx{s+1}{$a_{\stp+1}$}; &
    \elems[.75] &
    \elemx{s+c}{$a_{\stp+\cnt}$}; &
    \elems[1.5] &
    \elemx{ns+1}{$a_{n\stp+1}$}; &
    \elems[.5] &
    \elemx{ns+k}{$a_{n\stp+k}$}; \\
};

\iterateto{a1.north}
\iteratefromto{a1.north}{as+1.north}
\node at (last iteration) [label, above] {$+\texttt{step}$};
\iteratefrom{as+1.north}
\node at (last iteration) [label, above] {$+\texttt{step}$};
\iterateto{ans+1.north}
\node at (last iteration) [label, above] {$+\texttt{step}$};

\matrix [fptk, listx={b}{1.25}, below=3 of a] {
    \placeholder[1]{3.25} &
    \placeholder[2]{3.25} &
    \elems[.75] &
    \placeholder[n]{3.25} \\
};

\matrix at (b1) [fptk, list=c, element=a] {
    \elem{1} &
    \elems[.5] &
    \elemx{2}{$a_{\cnt}$}; \\
};

\matrix at (b2) [fptk, list=c, element=a] {
    \elemx{1}{$a_{\stp+1}$}; &
    \elems[.5] &
    \elemx{2}{$a_{\stp+\cnt}$}; \\
};

\matrix at (bn) [fptk, list=c, element=a] {
    \elemx{1}{$a_{n\stp\!+\!1}$}; &
    \elems[.25] &
    \elemx{2}{$a_{n\stp+k}$}; \\
};

\draw [fptk/measure, fptk/measure/label=\texttt{count}, fptk/measure/position=below] (a1.south west) -- (ac.south east);

\bracetobrace
    {[yshift=-.5\masterunit] ac.south east}{[yshift=-.5\masterunit] a1.south west}
    {b1.north west}{b1.north east}

\draw [fptk/measure, fptk/measure/label=\texttt{count}, fptk/measure/position=below] (as+1.south west) -- (as+c.south east);
\bracetobrace
    {[yshift=-.5\masterunit] as+c.south east}{[yshift=-.5\masterunit] as+1.south west}
    {b2.north west}{b2.north east}

\draw [fptk/measure, fptk/measure/label=$\le\texttt{count}$, fptk/measure/position=below] (ans+1.south west) -- (ans+k.south east);
\bracetobrace
    {[yshift=-.5\masterunit] ans+k.south east}{[yshift=-.5\masterunit] ans+1.south west}
    {bn.north west}{bn.north east}
