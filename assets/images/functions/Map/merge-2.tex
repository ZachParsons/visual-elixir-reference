\matrix [fptk, map=a1] {
    \keyvalue{1} &
    \elems &
    \keyvalue{i} &
    \elems &
    \keyvalue{i+j} \\
};

\matrix [fptk, map=a2, below=1.5 of a1i.south, matrix anchor=a2i.north] {
    \keyvalue{i} &
    \elems &
    \keyvalue{i+j} &
    \elems &
    \keyvalue{n} \\
};

\matrix [fptk, map=b, below=4 of a1.south west, anchor=north west] {
    \keyvalue{1} &
    \elems &
    \keyvalue{i} &
    \elems &
    \keyvalue{i+j} &
    \elems &
    \keyvalue{n} \\
};

\draw [dashed]
    ([yshift=.5\masterunit] a1i.north west) -- ([yshift=-.5\masterunit] a2i.south west)
    ([yshift=.5\masterunit] a1i+j.north east) -- ([yshift=-.5\masterunit] a2i+j.south east);

\bracetobrace
    {[yshift=-\masterunit] a1i.south west}
    {[yshift=-\masterunit] a11.south west}
    {b1.north west}
    {bi.north west}

\bracetobrace
    {[yshift=-\masterunit] a2n.south east}
    {[yshift=-\masterunit] a2i.south west}
    {bi.north west}
    {bn.north east}
