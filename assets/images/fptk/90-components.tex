\newcommand\applyfuntop[3][\texttt{fun}]{
    \draw [fptk, subflow ->] (#2) -- +(0, .5)
        node (fun) [fptk, fun=#1, above];
    \draw [fptk, subflow ->, shorten >=.75ex] (fun.north io) -- +(0, .5\masterunit + .75ex)
        node (last applied fun value) [anchor=base, font=\normalsize] {#3};
}

\newcommand\applyfunbottom[3][\texttt{fun}]{
    \draw [fptk, subflow ->] (#2) -- +(0, -.5)
        node (fun) [fptk, fun=#1, below];
    \draw [fptk, subflow ->, shorten >=2ex] (fun.south io) -- +(0, -.5\masterunit - 2ex)
        node (last applied fun value) [anchor=base, font=\normalsize] {#3};
}

\newcommand\measuretop[3]{
    \draw [
        fptk/measure,
        fptk/measure/distance=.5\masterunit,
        fptk/measure/label=#3
    ] (#1) -- (#2);
}

\newcommand\measurebottom[3]{
    \draw [
        fptk/measure,
        fptk/measure/distance=-.5\masterunit,
        fptk/measure/label=#3
    ] (#1) -- (#2);
}

\newcommand\predtop[3][1]{
    \draw [fptk, subflow ->, shorten >=1ex] (#2) -- +(0, #1)
        node (last predicate) [anchor=base, font=\normalsize] {#3};
}

\pgfkeys{
    /fptk/.cd,
    big arrow/.code={
        \pgfkeys{
            /tikz/.cd,
            draw,
            inner sep=0pt,
            line width=2.5\defaultpenwidth,
            minimum height=.4\masterunit,
            minimum width=.3\masterunit,
            node contents={},
            single arrow,
            single arrow tip angle=60,
            single arrow head extend=.02\masterunit,
        },
    },
}

\newcommand\bigarrowright[1]{
    \node (last bigarrow) at (#1) [fptk, big arrow];
}

\newcommand\bigarrowdown[1]{
    \node (last bigarrow) at (#1) [fptk, big arrow, rotate=-90];
}